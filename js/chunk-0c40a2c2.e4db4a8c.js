(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0c40a2c2"],{"6f6a":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-row",{attrs:{justify:"center"}},[a("b",{staticClass:"pb-5 pt-2 wrap--all"},[t._v(t._s(t.payload.location.name))]),a("v-btn",{attrs:{to:"/locations/"+t.payload.location.secretId,color:"primary",depressed:"",small:""}},[t._v(" View "),a("v-icon",{attrs:{right:""}},[t._v(" mdi-arrow-right ")])],1)],1)],1)},i=[],o=a("d4ec"),s=a("262e"),c=a("2caf"),l=a("9ab4"),r=a("60a3"),u=function(t){Object(s["a"])(a,t);var e=Object(c["a"])(a);function a(){return Object(o["a"])(this,a),e.apply(this,arguments)}return a}(r["e"]);Object(l["a"])([Object(r["c"])()],u.prototype,"payload",void 0),u=Object(l["a"])([r["a"]],u);var d=u,p=d,h=a("2877"),b=a("6544"),v=a.n(b),f=a("8336"),m=a("132d"),O=a("0fd9"),y=Object(h["a"])(p,n,i,!1,null,null,null);e["a"]=y.exports;v()(y,{VBtn:f["a"],VIcon:m["a"],VRow:O["a"]})},"9f8f":function(t,e,a){t.exports=a.p+"img/marker-icon-2x-red.07aea9c9.png"},a985:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{height:"100%",width:"100%"}},[t.showLocations&&t.locations.isLoading()?[a("v-skeleton-loader",{attrs:{dense:"",type:"image"}})]:!t.showLocations||t.locations.isSuccess()?[a("marker-map",{staticClass:"ma-auto",attrs:{height:t.height,width:t.width,zoom:t.zoom,center:t.center,"center-by-ip":t.centerByIp,"center-by-geo":t.centerByGeo,markers:t.markers,lines:t.lines,popupComponent:t.popupComponent,searchEnabled:t.searchEnabled},on:{searchClick:t.onSearchClick}})]:t.showLocations&&t.locations.isError()?[a("error-placeholder",{attrs:{"error-id":"locations"}})]:t._e()],2)},i=[],o=a("b85c"),s=a("d4ec"),c=a("bee2"),l=a("262e"),r=a("2caf"),u=(a("caad"),a("2532"),a("9ab4")),d=a("60a3"),p=a("e43f"),h=a("f789"),b=a("e11e"),v=a("cf57"),f=a("1cec"),m=a("2fd1"),O=function t(){Object(s["a"])(this,t)},y=a("1a32"),j=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-row",{attrs:{justify:"center"}},[a("b",{staticClass:"pb-5 pt-2 wrap--all"},[t._v(t._s(t.payload.location.name))]),t.payload.selected?a("v-btn",{attrs:{color:"error",depressed:"",small:""},on:{click:t.onButtonClick}},[t._v(" Remove "),a("v-icon",{attrs:{right:""}},[t._v(" mdi-delete ")])],1):a("v-btn",{attrs:{color:"primary",depressed:"",small:""},on:{click:t.onButtonClick}},[t._v(" Add to tour "),a("v-icon",{attrs:{right:""}},[t._v(" mdi-plus-circle-outline ")])],1)],1)},g=[],w=(a("d81d"),function(t){Object(l["a"])(a,t);var e=Object(r["a"])(a);function a(){return Object(s["a"])(this,a),e.apply(this,arguments)}return Object(c["a"])(a,[{key:"onButtonClick",value:function(){this.map&&this.map.closePopup(),this.payload.action(this.payload.location)}}]),a}(d["e"]));Object(u["a"])([Object(d["c"])()],w.prototype,"payload",void 0),Object(u["a"])([Object(d["c"])()],w.prototype,"map",void 0),w=Object(u["a"])([d["a"]],w);var S=w,I=S,k=a("2877"),x=a("6544"),C=a.n(x),V=a("8336"),L=a("132d"),_=a("0fd9"),E=Object(k["a"])(I,j,g,!1,null,null,null),T=E.exports;C()(E,{VBtn:V["a"],VIcon:L["a"],VRow:_["a"]});var D=function(){function t(e){Object(s["a"])(this,t),this.latLngs=e}return Object(c["a"])(t,[{key:"getLatLngTuples",value:function(){return this.latLngs.map((function(t){return[t.lat,t.lng]}))}}]),t}(),P=a("6f6a"),B=function(t){Object(l["a"])(n,t);var e=Object(r["a"])(n);function n(){var t;return Object(s["a"])(this,n),t=e.apply(this,arguments),t.locations=t.showLocations?p["a"].handle(v["a"].getAll(),{id:"locations",style:"SECTION"}):null,t}return Object(c["a"])(n,[{key:"popupComponent",get:function(){return this.showSelect?T:P["a"]}},{key:"onSearchClick",value:function(t,e){e.flyTo([t.y,t.x],15)}},{key:"markers",get:function(){var t,e=this,n=new Array,i=Object(o["a"])(this._tourLocations);try{for(i.s();!(t=i.n()).done;){var s=t.value,c=new b["LatLng"](s.latitude,s.longitude),l=new h["a"](c),r=new O;r.location=s,r.selected=!0,r.action=function(t){return y["a"].delete(e._tourLocations,t)},l.setPopupPayload(r),this.showSelect&&l.setIcon(new b["Icon"]({iconUrl:a("9f8f"),shadowUrl:a("e2b9"),iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})),n.push(l)}}catch(j){i.e(j)}finally{i.f()}if(this.locations&&this.locations.isSuccess()){var u,d=Object(o["a"])(this.locations.requireData());try{for(d.s();!(u=d.n()).done;){var p=u.value;if(!this._tourLocations.includes(p)){var v=new b["LatLng"](p.latitude,p.longitude),f=new h["a"](v),m=new O;m.location=p,m.selected=!1,m.action=function(t){return e._tourLocations.push(t)},f.setPopupPayload(m),n.push(f)}}}catch(j){d.e(j)}finally{d.f()}}return n}},{key:"lines",get:function(){for(var t=new Array,e=0;e<this._tourLocations.length-1;e++){var a=this._tourLocations[e],n=this._tourLocations[e+1],i=new b["LatLng"](a.latitude,a.longitude),o=new b["LatLng"](n.latitude,n.longitude),s=new D([i,o]);s.color=this.showSelect?"#c0392b":"#2980b9",t.push(s)}return t}}]),n}(d["e"]);Object(u["a"])([Object(d["d"])("tourLocations")],B.prototype,"_tourLocations",void 0),Object(u["a"])([Object(d["c"])()],B.prototype,"height",void 0),Object(u["a"])([Object(d["c"])()],B.prototype,"width",void 0),Object(u["a"])([Object(d["c"])()],B.prototype,"center",void 0),Object(u["a"])([Object(d["c"])({default:!1})],B.prototype,"centerByIp",void 0),Object(u["a"])([Object(d["c"])({default:!1})],B.prototype,"centerByGeo",void 0),Object(u["a"])([Object(d["c"])()],B.prototype,"zoom",void 0),Object(u["a"])([Object(d["c"])({default:!1})],B.prototype,"searchEnabled",void 0),Object(u["a"])([Object(d["c"])({default:!1})],B.prototype,"showLocations",void 0),Object(u["a"])([Object(d["c"])({default:!1})],B.prototype,"showSelect",void 0),B=Object(u["a"])([Object(d["a"])({components:{MarkerMap:m["a"],ErrorPlaceholder:f["a"]}})],B);var $=B,A=$,M=a("3129"),z=Object(k["a"])(A,n,i,!1,null,null,null);e["a"]=z.exports;C()(z,{VSkeletonLoader:M["a"]})},b0b0:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-toolbar",{attrs:{dark:"",color:"primary"}},[a("v-btn",{attrs:{icon:"",dark:""},on:{click:t.close}},[a("v-icon",[t._v("mdi-close")])],1),a("v-toolbar-title",[t._v("Create new tour")]),a("v-spacer"),a("v-toolbar-items",[1===t.stepper?a("v-btn",{attrs:{dark:"",text:""},on:{click:function(e){t.stepper=2}}},[t._v(" Continue ")]):2===t.stepper?a("v-btn",{attrs:{dark:"",text:"",disabled:t.loading,loading:t.loading},on:{click:t.create}},[t._v(" Save ")]):t._e()],1)],1),a("v-card-title",[t._v(" Create a new tour ")]),a("v-card-text",[t._v(" Follow the steps below to create a new tour. ")]),a("v-stepper",{staticClass:"elevation-0",model:{value:t.stepper,callback:function(e){t.stepper=e},expression:"stepper"}},[a("v-stepper-header",{staticClass:"elevation-0"},[a("v-stepper-step",{attrs:{editable:"",complete:t.stepper>1,step:1}},[t._v(" Information ")]),a("v-divider"),a("v-stepper-step",{attrs:{editable:"",complete:t.stepper>2,step:2}},[t._v(" Locations ")])],1),a("v-stepper-items",[a("v-stepper-content",{attrs:{step:"1"}},[a("v-form",{staticClass:"pt-1 pl-3"},[a("v-text-field",{attrs:{rules:t.fields.name.rules,"error-messages":t.fields.name.error,label:"Name",placeholder:"Name of the tour",disabled:t.loading,outlined:"",required:""},model:{value:t.fields.name.value,callback:function(e){t.$set(t.fields.name,"value",e)},expression:"fields.name.value"}}),a("editor",{attrs:{disabled:t.loading,title:"Description"},model:{value:t.fields.description.value,callback:function(e){t.$set(t.fields.description,"value",e)},expression:"fields.description.value"}}),a("div",{staticClass:"input__title"},[t._v("Listed")]),a("v-switch",{attrs:{label:"Should the tour be visible on the tours overview page.",disabled:t.loading},model:{value:t.fields.listed.value,callback:function(e){t.$set(t.fields.listed,"value",e)},expression:"fields.listed.value"}})],1)],1),a("v-stepper-content",{attrs:{step:"2"}},[a("v-form",{staticClass:"pt-1 pl-3"},[a("tour-map",{attrs:{height:"400px",width:"100%",zoom:2,"center-by-geo":!0,searchEnabled:!0,"tour-locations":t.fields.locations.value,"show-select":!0,"show-locations":!0},on:{"update:tourLocations":function(e){return t.$set(t.fields.locations,"value",e)},"update:tour-locations":function(e){return t.$set(t.fields.locations,"value",e)}}}),a("div",{staticClass:"mt-5"},[a("div",{staticClass:"text--secondary pb-4"},[t._v(" Selected locations ")]),a("v-combobox",{attrs:{chips:"",clearable:"","hide-no-data":"",label:"Selected locations","append-icon":"",multiple:"",solo:"",outlined:"",flat:""},scopedSlots:t._u([{key:"selection",fn:function(e){var n=e.attrs,i=e.item;return[a("v-chip",t._b({attrs:{close:""},on:{"click:close":function(e){return t.removeLocation(i)}}},"v-chip",n,!1),[a("strong",[t._v(" "+t._s(t.getLocationPosition(i)+1)+". "+t._s(i.name)+" ")])])]}}]),model:{value:t.fields.locations.value,callback:function(e){t.$set(t.fields.locations,"value",e)},expression:"fields.locations.value"}})],1)],1)],1)],1)],1)],1)},i=[],o=a("5530"),s=a("d4ec"),c=a("bee2"),l=a("262e"),r=a("2caf"),u=(a("d81d"),a("d3b7"),a("b0c0"),a("a4d3"),a("e01a"),a("9ab4")),d=a("60a3"),p=a("5c5a"),h=a("ceb0"),b=a("a985"),v=a("1a32"),f=a("8cd5"),m=a("ae0c"),O=a("f015"),y=function(t){Object(l["a"])(a,t);var e=Object(r["a"])(a);function a(){var t;return Object(s["a"])(this,a),t=e.apply(this,arguments),t.loading=!1,t.stepper=1,t.fields={name:new p["a"],description:new p["a"],listed:new p["a"]({value:!0}),active:new p["a"]({value:!0}),locations:new p["a"]({value:[]})},t}return Object(c["a"])(a,[{key:"updateMap",value:function(){2==this.stepper&&window.dispatchEvent(new Event("resize"))}},{key:"close",value:function(){this.$store.dispatch("modal/close")}},{key:"create",value:function(){var t=this,e=this.fields.locations.value.map((function(t){return t.secretId})),a=Object(o["a"])(Object(o["a"])({},O["a"].getValues(this.fields)),{},{locations:e});this.loading=!0,m["a"].create(a).then((function(e){t.$store.dispatch("snackbar/open",{message:"Tour was successfully created",color:"success"}),t.$store.dispatch("modal/close"),t.$router.push("/tours/".concat(e.secretId))})).catch((function(e){f["a"].handle(e,{style:"SNACKBAR",id:"tourCreate"},t.fields),(t.fields.name.error||t.fields.description.error)&&(t.stepper=1)})).finally((function(){return t.loading=!1}))}},{key:"getLocationPosition",value:function(t){return this.fields.locations.value.indexOf(t)}},{key:"removeLocation",value:function(t){v["a"].delete(this.fields.locations.value,t)}}]),a}(d["e"]);Object(u["a"])([Object(d["f"])("stepper")],y.prototype,"updateMap",null),y=Object(u["a"])([Object(d["a"])({components:{TourMap:b["a"],Editor:h["a"]}})],y);var j=y,g=j,w=a("2877"),S=a("6544"),I=a.n(S),k=a("8336"),x=a("99d9"),C=a("cc20"),V=(a("25f0"),a("7db0"),a("8a79"),a("fb6a"),a("caad"),a("2532"),a("a434"),a("2bfd"),a("b974")),L=a("c6a6"),_=a("80d2"),E=L["a"].extend({name:"v-combobox",props:{delimiters:{type:Array,default:function(){return[]}},returnObject:{type:Boolean,default:!0}},data:function(){return{editingIndex:-1}},computed:{computedCounterValue:function(){return this.multiple?this.selectedItems.length:(this.internalSearch||"").toString().length},hasSlot:function(){return V["a"].options.computed.hasSlot.call(this)||this.multiple},isAnyValueAllowed:function(){return!0},menuCanShow:function(){return!!this.isFocused&&(this.hasDisplayedItems||!!this.$slots["no-data"]&&!this.hideNoData)},searchIsDirty:function(){return null!=this.internalSearch}},methods:{onInternalSearchChanged:function(t){if(t&&this.multiple&&this.delimiters.length){var e=this.delimiters.find((function(e){return t.endsWith(e)}));null!=e&&(this.internalSearch=t.slice(0,t.length-e.length),this.updateTags())}this.updateMenuDimensions()},genInput:function(){var t=L["a"].options.methods.genInput.call(this);return delete t.data.attrs.name,t.data.on.paste=this.onPaste,t},genChipSelection:function(t,e){var a=this,n=V["a"].options.methods.genChipSelection.call(this,t,e);return this.multiple&&(n.componentOptions.listeners=Object(o["a"])(Object(o["a"])({},n.componentOptions.listeners),{},{dblclick:function(){a.editingIndex=e,a.internalSearch=a.getText(t),a.selectedIndex=-1}})),n},onChipInput:function(t){V["a"].options.methods.onChipInput.call(this,t),this.editingIndex=-1},onEnterDown:function(t){t.preventDefault(),this.getMenuIndex()>-1||this.$nextTick(this.updateSelf)},onFilteredItemsChanged:function(t,e){this.autoSelectFirst&&L["a"].options.methods.onFilteredItemsChanged.call(this,t,e)},onKeyDown:function(t){var e=t.keyCode;!t.ctrlKey&&[_["y"].home,_["y"].end].includes(e)||V["a"].options.methods.onKeyDown.call(this,t),this.multiple&&e===_["y"].left&&0===this.$refs.input.selectionStart?this.updateSelf():e===_["y"].enter&&this.onEnterDown(t),this.changeSelectedIndex(e)},onTabDown:function(t){if(this.multiple&&this.internalSearch&&-1===this.getMenuIndex())return t.preventDefault(),t.stopPropagation(),this.updateTags();L["a"].options.methods.onTabDown.call(this,t)},selectItem:function(t){this.editingIndex>-1?this.updateEditing():(L["a"].options.methods.selectItem.call(this,t),this.internalSearch&&this.multiple&&this.getText(t).toLocaleLowerCase().includes(this.internalSearch.toLocaleLowerCase())&&(this.internalSearch=null))},setSelectedItems:function(){null==this.internalValue||""===this.internalValue?this.selectedItems=[]:this.selectedItems=this.multiple?this.internalValue:[this.internalValue]},setValue:function(t){var e;V["a"].options.methods.setValue.call(this,null!=(e=t)?e:this.internalSearch)},updateEditing:function(){var t=this.internalValue.slice();t[this.editingIndex]=this.internalSearch,this.setValue(t),this.editingIndex=-1},updateCombobox:function(){if(this.searchIsDirty){this.internalSearch!==this.getText(this.internalValue)&&this.setValue();var t=Boolean(this.$scopedSlots.selection)||this.hasChips;t&&(this.internalSearch=null)}},updateSelf:function(){this.multiple?this.updateTags():this.updateCombobox()},updateTags:function(){var t=this.getMenuIndex();if(!(t<0)||this.searchIsDirty){if(this.editingIndex>-1)return this.updateEditing();var e=this.selectedItems.indexOf(this.internalSearch);if(e>-1){var a=this.internalValue.slice();a.splice(e,1),this.setValue(a)}if(t>-1)return this.internalSearch=null;this.selectItem(this.internalSearch),this.internalSearch=null}},onPaste:function(t){var e;if(this.multiple&&!this.searchIsDirty){var a=null==(e=t.clipboardData)?void 0:e.getData("text/vnd.vuetify.autocomplete.item+plain");a&&-1===this.findExistingIndex(a)&&(t.preventDefault(),V["a"].options.methods.selectItem.call(this,a))}}}}),T=a("ce7e"),D=a("4bd4"),P=a("132d"),B=a("2fa4"),$=a("7e85"),A=a("e516"),M=a("9c54"),z=a("56a4"),F=a("b73d"),G=a("8654"),N=a("71d9"),K=a("2a7f"),R=Object(w["a"])(g,n,i,!1,null,null,null);e["default"]=R.exports;I()(R,{VBtn:k["a"],VCardText:x["c"],VCardTitle:x["d"],VChip:C["a"],VCombobox:E,VDivider:T["a"],VForm:D["a"],VIcon:P["a"],VSpacer:B["a"],VStepper:$["a"],VStepperContent:A["a"],VStepperHeader:M["a"],VStepperItems:M["b"],VStepperStep:z["a"],VSwitch:F["a"],VTextField:G["a"],VToolbar:N["a"],VToolbarItems:K["a"],VToolbarTitle:K["b"]})},cf57:function(t,e,a){"use strict";var n=a("d4ec"),i=a("bee2"),o=a("262e"),s=a("2caf"),c=a("9ab4"),l=a("d70b"),r=a("c1c4"),u=a("3dcf"),d=function(t){Object(o["a"])(a,t);var e=Object(s["a"])(a);function a(){return Object(n["a"])(this,a),e.apply(this,arguments)}return Object(i["a"])(a,[{key:"get",value:function(t){return{}}},{key:"getAll",value:function(){return{}}},{key:"getStatistics",value:function(t){return{}}},{key:"getVisits",value:function(t){return{}}},{key:"getLocationByVisitSecret",value:function(t){return{}}},{key:"visitLocation",value:function(t){return{}}},{key:"create",value:function(t){return{}}},{key:"delete",value:function(t){return{}}},{key:"update",value:function(t,e){return{}}}]),a}(r["EchoService"]);Object(c["a"])([Object(r["GET"])("/locations/{secretId}"),Object(c["b"])(0,Object(r["Path"])("secretId"))],d.prototype,"get",null),Object(c["a"])([Object(r["GET"])("/locations")],d.prototype,"getAll",null),Object(c["a"])([Object(r["GET"])("/locations/{secretId}/statistics"),Object(c["b"])(0,Object(r["Path"])("secretId"))],d.prototype,"getStatistics",null),Object(c["a"])([Object(r["GET"])("/locations/{secretId}/visits"),Object(c["b"])(0,Object(r["Path"])("secretId"))],d.prototype,"getVisits",null),Object(c["a"])([Object(r["GET"])("/locations/visits/{visitSecret}"),Object(c["b"])(0,Object(r["Path"])("visitSecret"))],d.prototype,"getLocationByVisitSecret",null),Object(c["a"])([Object(r["POST"])("/locations/visits/{visitSecret}"),Object(c["b"])(0,Object(r["Path"])("visitSecret"))],d.prototype,"visitLocation",null),Object(c["a"])([Object(r["POST"])("/locations"),Object(c["b"])(0,Object(r["Body"])())],d.prototype,"create",null),Object(c["a"])([Object(r["DELETE"])("/locations/{secretId}"),Object(c["b"])(0,Object(r["Path"])("secretId"))],d.prototype,"delete",null),Object(c["a"])([Object(r["PATCH"])("/locations/{secretId}"),Object(c["b"])(0,Object(r["Path"])("secretId")),Object(c["b"])(1,Object(r["Body"])())],d.prototype,"update",null),e["a"]=(new r["EchoServiceBuilder"]).setBaseUrl(l["a"].BACKEND.URL).addInterceptor(new u["a"]).build(d)}}]);
//# sourceMappingURL=chunk-0c40a2c2.e4db4a8c.js.map